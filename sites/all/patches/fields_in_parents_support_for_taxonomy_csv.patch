From 6eb318c42c4096d03d1e641134e700f0571913b5 Mon Sep 17 00:00:00 2001
From: Ignacio Segura <nacho@isegura.es>
Date: Tue, 8 Nov 2016 10:48:27 +0100
Subject: [PATCH] 293 - Path file storing module changes

---
 .../patches/countries_support_for_taxonomy_csv.patch   | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 sites/all/patches/countries_support_for_taxonomy_csv.patch

diff --git a/sites/all/patches/countries_support_for_taxonomy_csv.patch b/sites/all/patches/countries_support_for_taxonomy_csv.patch
new file mode 100644
index 0000000..3d8cf7f
--- /dev/null
+++ b/sites/all/patches/countries_support_for_taxonomy_csv.patch
@@ -0,0 +1,18 @@
+diff --git a/import/taxonomy_csv.import.line.api.inc b/import/taxonomy_csv.import.line.api.inc
+index e0fe714..de1d034 100644
+--- a/import/taxonomy_csv.import.line.api.inc
++++ b/import/taxonomy_csv.import.line.api.inc
+@@ -882,6 +882,13 @@ function _taxonomy_csv_term_field_import($term, $update_or_ignore = TAXONOMY_CSV
+           $term->{$field_name}[$language][0] = array('value' => $value);
+           break;
+ 
++        case 'country':
++          $country = country_load($values[0]);
++          if ($country && $country->enabled == true) {
++            $term->{$field_name}[$language][0] = array('iso2' => $values[0]);
++          }
++          break;
++
+         // Managed by default:
+         // case 'number_decimal':
+         // case 'number_integer':
-- 
1.7.11.1

From a10ab3cb2df1ba1209624af206e380a0991a445e Mon Sep 17 00:00:00 2001
From: Ignacio Segura <nacho@isegura.es>
Date: Thu, 10 Nov 2016 10:49:17 +0100
Subject: [PATCH] 293 - Default value for form item

---
 sites/all/modules/taxonomy_csv/import/taxonomy_csv.import.admin.inc | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/sites/all/modules/taxonomy_csv/import/taxonomy_csv.import.admin.inc b/sites/all/modules/taxonomy_csv/import/taxonomy_csv.import.admin.inc
index 9f8a170..0f71e42 100644
--- a/sites/all/modules/taxonomy_csv/import/taxonomy_csv.import.admin.inc
+++ b/sites/all/modules/taxonomy_csv/import/taxonomy_csv.import.admin.inc
@@ -304,7 +304,6 @@ function taxonomy_csv_import_form($form, &$form_state) {
       . '<ul>'
         . '<li>' . t('First item of the format should be "tree" or "poly", depending on your choice.') . '</li>'
         . '<li>' . t('This first item should not be repeated, unlike fields.') . '</li>'
-        . '<li>' . t('The fields are always attached to the last term of the tree.') . '</li>'
         . '<li>' . t('On the imported csv line, empty fields should always be marked, <em>particularly at the end of the line</em>. In the previous example, there are a first field and a third field only for <code>Europe</code>, neither for <code>France</code> nor <code>Lyon</code>), but they are marked in them with an empty content.') . '</li>'
         . '<li>' . t('On the imported csv line, you can add empty names in order to begin the fields at the same column on each line.') . '</li>'
       . '</ul>'
@@ -327,7 +326,7 @@ function taxonomy_csv_import_form($form, &$form_state) {
   $form['tab']['format']['specific'][TAXONOMY_CSV_FORMAT_FIELDS]['import_fields_parents'] = array(
     '#type'          => 'radios',
     '#title'         => t('Should field values be applied to all items found per line, or only to last item (deepest element)?'),
-    '#default_value' => $list_previous_values['import_fields_parents'],
+    '#default_value' => $list_previous_values['import_fields_parents'] ? $list_previous_values['import_fields_parents'] : 'child-only',
     '#options'         => array(
       'all-ancestors' => t('Yes, apply field values to current term and all its ancestors.'),
       'child-only'  => t('No, apply field values to deepest child only.'),
-- 
1.7.11.1

